/****************************************************************************
 * activeScene.js
 ***************************************************************************/

(function( babylonProject,  undefined )
{
    babylonProject.activeScene = null;

    babylonProject.changeScene = function( sceneCreationFunction ) 
    {
        babylonProject.activeScene = sceneCreationFunction();
    };

} ( window.babylonProject = window.babylonProject || {} ));

/****************************************************************************
 * externalDependencies.js
 *
 * Pointers to external objects such as DOM objects and library objects
 * are managed within this file.
 *
 * Mocking the values from this file allows the dependencies to be mocked
 * during testing.
 ***************************************************************************/


( function ( babylonProject, undefined )
{
    //HTML Canvas DOM object that is used for rendering.
    babylonProject.canvas = null;

    //pointer to the BABYLON library object.
    babylonProject.BABYLON = null;

    //reference to the Babylon 3D engine
    babylonProject.engine = null;

} ( window.babylonProject = window.babylonProject || {} ));


/****************************************************************************
 * jQueryDomFunctions.js
 * 
 * Functions where the game interacts with the DOM are defined here.
 ***************************************************************************/

(function( babylonProject, startScene, $,  undefined )
{
    //Called when all HTML/DOM objects have been loaded.
    $(document).ready(function() 
    {
        babylonProject.canvas = document.querySelector("#renderCanvas");
        
        babylonProject.BABYLON = BABYLON;

        babylonProject.engine =
            new BABYLON.Engine(babylonProject.canvas, true);

        babylonProject.changeScene ( babylonProject.startScene );

        // Register a render loop to repeatedly render the scene
        babylonProject.engine.runRenderLoop(function ()
        {
            babylonProject.activeScene.render();
        });
    });

    //Dynamically resizes the canvas as the browser window changes.
    $(window).on("resize load", function()
    {
        if ( babylonProject.engine )
        {
            babylonProject.engine.resize();
        }
    });

} ( window.babylonProject = window.babylonProject || {},
    window.startScene = window.startScene || {},
    jQuery));

(function( babylonProject ,  undefined )
{
    babylonProject.startScene = function(  ) 
    {
        var BABYLON = babylonProject.BABYLON;

        // Now create a basic Babylon Scene object
        var scene = new BABYLON.Scene(babylonProject.engine);

        // Change the scene background color to dark green.
        scene.clearColor = new BABYLON.Color3(0, 0.3, 0);

        // This creates and positions a free camera
        var camera = new BABYLON.FreeCamera(
                "camera1",
                new BABYLON.Vector3(0, 5, -10),
                scene);

        // This targets the camera to scene origin
        camera.setTarget(BABYLON.Vector3.Zero());
        
        // This attaches the camera to the canvas
        camera.attachControl(babylonProject.canvas, false);
       
        // This creates a light, aiming 0,1,0 - to the sky.
        var light = new BABYLON.HemisphericLight(
                "light1",
                new BABYLON.Vector3(0, 1, 0),
                scene);

        // Dim the light a small amount
        light.intensity = .5;

        // Let's try our built-in 'sphere' shape.
        var sphere = BABYLON.MeshBuilder.
            CreateSphere("sphere1",
                         { segments : 16, diameter: 2},
                         scene);
      
        // Move the sphere upward 1/2 its height
        sphere.position.y = 1;
     
        // Let's try our built-in 'ground' shape.
        var ground = BABYLON.MeshBuilder.
            CreateGround("ground1",
                        { width : 6, height : 6, subdivisions : 2},
                        scene);

        return scene;
    };

} ( window.babylonProject = window.babylonProject || {} ));
